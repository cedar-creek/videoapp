(()=>{document.querySelector("#start-camera");let e=document.querySelector("#video"),t=document.querySelector("#start-record"),n=document.querySelector("#stop-record"),o=document.querySelector("#download-video"),i=null,c=null,d=[],a=!0;e.muted=!0;let r={audio:!0,video:{facingMode:{exact:"user"}}};async function u(t){i=await navigator.mediaDevices.getUserMedia(t),document.querySelector(".overlay").style.display="block",e.srcObject=i}function l(){if(null==i)return;const e=i.getTracks();if(e)for(let t=0;t<e.length;t++)e[t].stop()}function s(){90==window.orientation&&(r.video.aspectRatio=16/9),0==window.orientation&&(r.video.aspectRatio=9/16),l(),u(r)}t.addEventListener("click",(function(){c=new MediaRecorder(i,{mimeType:"video/webm"}),c.addEventListener("dataavailable",(function(e){d.push(e.data)})),c.addEventListener("stop",(function(){let e=URL.createObjectURL(new Blob(d,{type:"video/webm"}));o.href=e})),c.start(1e3)})),n.addEventListener("click",(function(){c.stop()})),document.getElementById("flip-button").onclick=function(){a=!a,r.video.facingMode.exact=a?"user":"environment",l(),u(r)},window.addEventListener("orientationchange",s,!1),s()})();